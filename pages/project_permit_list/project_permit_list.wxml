<view class="container">
  <!-- 顶部自定义导航栏 -->
  <navBar
    class="navbar"
    title="我的项目"
    background="#222831"
    color="#fff"
    back="{{true}}"
    home="{{true}}"
    iconTheme="white"
    bindback="handlerGobackClick"
    bindhome="handlerGohomeClick"
  />

  <!-- 顶部状态切换栏 -->
  <view class="tab">
    <text
      bindtap="onTabChange"
      data-tab="0"
      class="{{activeTab==0?'active':''}}"
    >
      待审核
    </text>
    <text
      bindtap="onTabChange"
      data-tab="1"
      class="{{activeTab==1?'active':''}}"
    >
      进行中
    </text>
    <text
      bindtap="onTabChange"
      data-tab="2"
      class="{{activeTab==2?'active':''}}"
    >
      已打回
    </text>
  </view>

  <!-- 列表区域 -->
  <scroll-view scroll-y="true" class="list-scroll">

    <!-- 有数据时 -->
    <block wx:if="{{filteredList.length > 0}}">
      <block wx:for="{{filteredList}}" wx:key="project_id">
        <view class="item-container">
          <!-- 左侧：项目名 + 时间 + 状态 -->
          <view class="item-details">
            <!-- 项目名 -->
            <view class="name">
              {{item.project_name || '无项目名称'}}
            </view>
            <!-- 申请创建时间标签 -->
            <view class="label">申请创建时间：</view>

            <!-- 时间 + 状态同一行 -->
            <view class="time-and-state">
              <text class="create-time">
                {{item.created_at}}
              </text>

              <!-- 状态胶囊：注意 class 写在一行 -->
              <view class="state {{item.state==0?'state-pending':(item.state==1?'state-running':'state-rejected')}}">
                {{item.state==0?'待审核':(item.state==1?'进行中':'已打回')}}
              </view>
            </view>
          </view>

          <!-- 右侧详情按钮 -->
          <view
            class="detail-btn"
            data-id="{{item.project_id}}"
            bindtap="goDetail"
          >
            详情
          </view>
        </view>
      </block>
    </block>

    <!-- 无数据时 -->
    <block wx:else>
      <view class="empty-hint">
        <text>(≧∀≦)ゞ{'\n'}当前状态下暂无项目</text>
      </view>
    </block>

    <view class="safe-bottom"></view>
  </scroll-view>
</view>
